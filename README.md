# Post-Install Manager

Post-Install Manager - это программа для установки приложений после установки
Windows. Она поможет системным администраторам при формировании сборок. По
назначению и общему принципу работы аналогична WPI.

Несмотря на более простой и менее настраиваемый интерфейс, программа способна
устанавливать другие программы и производить некоторые другие действия с
файловой системой (создавать, копировать и удалять папки, перемещать и 
переименовывать файлы и папки, копировать и удалять файлы).

## Описание формата репозитория

Для получения информации об устанавливаемых программах используется файл
pim.xml следующего формата:

- коренной элемент `pim-repository`, который может содержать элемент
  `programs`;

- внутри элемента `programs` может находится произвольное количество элементов
  `program` - описателей программы;

- внутри элемента `program` могут находиться следующие элементы:

  - `name` - название программы;

  - `commands` - список команд.

- внутри элемента `commands` находятся элементы `command`, порядок этих
  элементов задаёт порядок выполнения команд при установке программы;

- внутри элемента `command` могут находиться следующие элементы:

  - `arch` - обозначение, при какой архитектуре может сработать данная команда:

    - `x86` - 32-битные версии Windows;

    - `x64` - 64-битные версии Windows (AMD64 и ARM); 

    - `amd64`, `x86_64`, `x86-64` - версии Windows для AMD64;

    - `arm64` - версии Windows для ARM.

    Несколько элементов `arch` объединяются оператором ИЛИ.

  - `os` - обозначение, при какой операционной системе может сработать данная
    команда: `XP`, `Vista`, `7`, `8`, `8.1`, `10`, `11`.

    Объединяется с элементом `arch` оператором И.
 
  - элемент, определяющий команду:

    - `alert` - вывод предупреждения;

    - `fail` - вывод ошибки;

    - `exec` - запуск исполняемого файла, принимает аргументы:

      - элемент `file` - путь к исполняемому файлу, может содержать макрос
        `%pimpath%`, который заменяется на путь к директории, где находится
        основной исполняемый файл;
  
      - элемент `args` - аргументы для запуска файла, поле необязательно.

   - `cmd` - запуск команды через командную строку;

   - `cpfile` - скопировать файл;

   - `rmfile` - удалить файл;

   - `cpdir` - скопировать папку;

   - `rmdir` - удалить папку вместе с файлами;

   - `move` - переместить файл;

     Принимают аргументы:

     - `from` - исходный путь;

     - `to` - путь назначения.

   - `rename` - переименовать файл. Принимает аргументы в виде элементов:

     - `path` - путь к файлу;

     - `new-name` - новое имя файла.

## TODO

### модель данных

- [X] категории программ

- [ ] параметры по умолчанию

- [ ] зависимости и взаимоисключающие программы

### стилистические особенности

- [ ] новый стиль мастера для Windows Vista и выше

- [ ] взаимодействие с прогрессбаром в панели задач


